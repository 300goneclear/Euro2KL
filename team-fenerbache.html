<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Fenerbache · Euro2KLeague</title>
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@700&family=Inter:wght@400;700&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="mini.css" />
</head>
<body>
<main class="container" style="padding:12px 0 28px">
  <section class="card" style="padding:14px">
    <h1 style="margin:0 0 6px">Fenerbache Official</h1>
    <p class="muted" style="margin:0">Team roster and season stats (auto-synced from site data).</p>
  </section>

  <section class="card" style="margin-top:14px">
    <h2 style="padding:12px 16px;margin:0;border-bottom:1px solid var(--border)">Roster & Averages</h2>
    <div class="table"><table id="roster">
      <thead><tr>
        <th>Player</th><th>GP</th><th>PPG</th><th>RPG</th><th>APG</th><th>SPG</th><th>BPG</th><th>FG%</th><th>3P%</th>
      </tr></thead><tbody></tbody>
    </table></div>
  </section>

  <section class="card" style="margin-top:14px">
    <h2 style="padding:12px 16px;margin:0;border-bottom:1px solid var(--border)">Fenerbache Dashboard</h2>
    <div class="grid">
      <div class="card" style="padding:14px"><div class="muted">Record</div><div id="rec" style="font-size:28px;font-weight:800">—</div><div id="form" class="muted" style="margin-top:6px">Form: —</div></div>
      <div class="card" style="padding:14px"><div class="muted">Points For / Against</div><div id="pfpa" style="font-size:28px;font-weight:800">—</div><div id="diff" class="muted" style="margin-top:6px">Diff: —</div></div>
      <div class="card" style="padding:14px"><div class="muted">Last Result</div><div id="last" style="font-size:18px;font-weight:700;line-height:1.35">—</div></div>
    </div>
  </section>

  <section class="card" style="margin-top:14px">
    <h2 style="padding:12px 16px;margin:0;border-bottom:1px solid var(--border)">Schedule</h2>
    <div class="table"><table id="sched">
      <thead><tr><th>Date</th><th>Opponent</th><th>Result</th><th>Status</th></tr></thead><tbody></tbody>
    </table></div>
  </section>
</main>

<script>
const BASE = (()=>{ const s = location.pathname.split('/').filter(Boolean); return s.length ? '/' + s[0] + '/' : '/'; })();
const pct = (m,a) => a ? ((m/a)*100).toFixed(1)+'%' : '—';
const per = (n,g) => g ? (n/g).toFixed(1) : '0.0';
async function getJSON(path){
  const url = BASE + path;
  const r = await fetch(url, {cache:'no-store'});
  if(!r.ok) throw new Error(url + ' ' + r.status);
  return r.json();
}
</script>

<script>
const TEAM = 'Fenerbache';
(async () => {
  const [players, standings, games] = await Promise.all([
    getJSON('assets/data/players.json'),
    getJSON('assets/data/standings.json'),
    getJSON('assets/data/games.json')
  ]);

  const rows = players.filter(p => (p.team||'').toLowerCase() === TEAM.toLowerCase());
  const body = document.querySelector('#roster tbody');
  if(!rows.length){ body.innerHTML='<tr><td colspan="9" style="padding:16px;color:#a8b4d8">No players yet for this team.</td></tr>'; }
  rows.forEach(p => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${p.name}</td><td>${p.gp||0}</td><td>${per(p.pts||0,p.gp||1)}</td>
      <td>${per(p.reb||0,p.gp||1)}</td><td>${per(p.ast||0,p.gp||1)}</td>
      <td>${per(p.stl||0,p.gp||1)}</td><td>${per(p.blk||0,p.gp||1)}</td>
      <td>${pct(p.fgm||0,p.fga||0)}</td><td>${pct(p.tpm||0,p.tpa||0)}</td>`;
    body.appendChild(tr);
  });

  const s = standings.find(x => (x.team||'').toLowerCase()===TEAM.toLowerCase()) || {wins:0,losses:0,pf:0,pa:0};
  document.getElementById('rec').textContent = `${s.wins}–${s.losses}`;
  document.getElementById('pfpa').textContent = `${s.pf} / ${s.pa}`;
  const d = (s.pf - s.pa); document.getElementById('diff').textContent = `Diff: ${d>0?'+':''}${d}`;
  document.getElementById('form').textContent = 'Form: ' + (s.wins>0?'W':'L');

  const body2 = document.querySelector('#sched tbody'); body2.innerHTML='';
  const myGames = games.filter(g => g.home===TEAM || g.away===TEAM);
  myGames.forEach(g => {
    const opp = g.home===TEAM ? g.away : g.home;
    const res = g.status==='final' ? `${g.home===TEAM?g.homeScore:g.awayScore}–${g.home===TEAM?g.awayScore:g.homeScore}` : '—';
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${g.date||'TBA'}</td><td>${opp}</td><td>${res}</td><td>${g.status}</td>`;
    body2.appendChild(tr);
  });
  const finals = myGames.filter(g=>g.status==='final');
  if(finals.length){
    const g = finals[finals.length-1];
    const hs = g.home===TEAM?g.homeScore:g.awayScore, as = g.home===TEAM?g.awayScore:g.homeScore;
    const opp = g.home===TEAM?g.away:g.home; const W = hs>as?'W':'L';
    document.getElementById('last').innerHTML = `<strong>${W}</strong> vs ${opp} — ${hs}–${as} (${g.date||'TBA'})`;
  }
})().catch(e => {
  console.error(e);
  document.querySelector('#roster tbody').innerHTML =
    '<tr><td colspan="9" style="padding:16px;color:#a8b4d8">Could not load assets/data/*.json — check paths/casing.</td></tr>';
});
</script>
</body>
</html>
